

Music Like アプリ 仕様概要書（UI・機能）
1. 対象アプリ概要
アプリ名：Music Like
ベースアプリ：Apple Music
アプリアイコン：app_icon.png
主目的：
音楽のストリーミング再生、楽曲管理、プレイリスト作成、レコメンド、歌詞表示、ダウンロード再生

2. 全体UI構成
2.1 画面レイアウトの基本構造
上部
ナビゲーションバー
画面タイトル
検索アイコン（該当画面のみ）
編集・追加ボタン（ライブラリ系画面）
中央
コンテンツ表示エリア（リスト／カード／グリッド）
下部
ミニプレイヤー
再生中の楽曲情報（ジャケット、曲名、アーティスト）
再生／停止ボタン
タブバー（常時表示）

3. タブバー仕様（下部固定）
3.1 タブ構成
タブ名
・ライブラリ（ユーザーの楽曲管理）
・設定（アプリ全体設定・ローカル読込機能管理）

※ iOS設定や地域によって並び順・名称が若干変わる場合あり

4. 各タブ詳細仕様

4.1 ライブラリ
表示要素
・検索（アイコンタップで文字入力して表示を絞り込みする）
・プレイリスト（プレイリストを表示→曲のリストを表示）
・アーティスト（アーティストのリストを表示→曲のリストを表示）
・アルバム（アルバムのリストを表示→曲のリストを表示）
・曲（曲のリストを表示）
UI仕様
・リスト形式
編集ボタンで表示項目のON/OFF可能
各項目タップで詳細一覧へ遷移
機能
・楽曲の再生
・並び替え（昇順/降順）
・プレイリスト作成・編集
4.2 検索
UI構成
・上部検索バー
・サジェストリスト
・カテゴリ検索
検索対象
・曲名
・アーティスト
・アルバム
・プレイリスト
・歌詞（部分一致）

5. 再生画面（フルプレイヤー）
表示要素
・アルバムジャケット（中央）
・曲名
・アーティスト名
・再生位置スライダー
・再生コントロール
・再生／停止
・前へ／次へ
・10秒戻し/10秒送り
・再生速度（1.25倍、1.5倍、2倍）
・シャッフル（デフォルトは曲名昇順で再生→再生キューをランダムにする）
・リピート
ボタン配置構成
「
1段目：前へ、10秒戻し、再生/停止、10秒送り、次へ
2段目：1.25×、1.5×、2×、シャッフル、リピート」
拡張UI
・歌詞表示（同期スクロール）
・AirPlay選択
・音質表示（ロスレス／空間オーディオ）
・キュー表示
楽曲単位 音量オフセット調整（再生画面上部にアイコン表示）





6. 歌詞表示機能
仕様
・時間同期型スクロール
・現在行を強調表示
・行タップで再生位置ジャンプ

7. 音質・再生仕様
対応フォーマット
AAC
MP3
flac
.m4a (.aiff)
.wav
Dolby Atmos（空間オーディオ）
設定連動
iOS「設定」アプリから制御
モバイル通信／Wi-Fi別設定可能

8. Siri・Google アシスタントシステム連携
・アシスタントの音声操作
・ロック画面操作
・コントロールセンター操作
・CarPlay対応

9. 設定画面（追加）
9.1 音声取得・変換設定
・YouTube URL入力欄+クリップボード貼り付け
・ダウンロードボタン（バックグラウンドでダウンロード処理してローカルに保存＆ライブラリに追加）
・出力形式（MP3 / M4A）
・ビットレート設定
・サンプリングレート設定



9.2 ローカルファイル読み込み設定
・ファイル選択ダイアログ（音声ファイル：AAC/MP3/FLAC/M4A / AIFF/WAV、歌詞ファイル：LRC）
・フォルダ選択ダイアログ（フォルダ内の全ての対応フォーマットを読込する）
・対応フォーマット表示（音声ファイル：AAC/MP3/FLAC/M4A / AIFF/WAV、歌詞ファイル：LRC）
・重複検出ポリシー設定 ON / OFF（追加したタイトルが重複した曲の古い方を削除する）


9.3 歌詞（LRC）表示設定
・歌詞表示 ON / OFF
・表示行数設定（前後行数）
・フォントサイズ・強調表示設定


10．Music Likeのカラーデザイン

メインカラー
#FF2D55（iOS 系でおなじみの赤）
AppBar
フラット（elevation 0）
中央タイトル
BottomNavigationBar
選択中だけ赤
未選択はグレー
Slider
再生位置バーを想定した配色



Music Like 基本操作方法（スマホ版）
1. タップ操作（基本中の基本）
単タップ
楽曲 → 再生開始
アルバム／プレイリスト → 詳細画面へ遷移
再生ボタン → 再生／停止切り替え

2. 長押し操作（最重要）
楽曲・アルバム・プレイリストを長押し
表示されるコンテキストメニュー：
再生
次に再生
プレイリストに追加
編集：曲の場合→メタ情報の編集・または曲の削除、プレイリストの場合→プレイリストの名前変更・削除


3. スワイプ操作
左スワイプ（曲リスト内）
プレイリストから削除
上スワイプ（ミニプレイヤー）
ミニプレイヤー → フル再生画面へ
下スワイプ（フル再生画面）
フル再生画面 → ミニプレイヤーへ戻る

4. ドラッグ操作
再生位置バーをドラッグ
曲の任意の位置へジャンプ
キュー（次に再生）画面でドラッグ
再生順序の変更
ドラッグハンドルを上下移動

5. プレイヤー画面の操作
ジャケット画像タップ
歌詞表示／非表示の切り替え（対応曲）
歌詞画面の操作
行をタップ → その位置から再生
スクロール → 任意の歌詞へ移動

6. シャッフル・リピート・再生速度操作
操作方法
再生画面下部のアイコンをタップ
「状態」
シャッフル
・オフ／オン
リピート
・オフ → 全曲 → 1曲
再生速度
・オフ／オン


7. 検索画面の操作
検索バー操作
タップ → キーボード表示
入力途中でサジェスト表示
キャンセル → 検索終了

8. プレイリスト編集操作
編集方法
プレイリストを開く
右上「編集」をタップ
曲をドラッグで並び替え
削除は左スワイプ

9. AirPlay・デバイス切り替え
操作
再生画面右下のAirPlayアイコン
出力先を選択

10. ロック画面・コントロールセンター操作
ロック画面
再生／停止
曲送り／戻し
コントロールセンター
長押しで再生デバイス切替
再生操作


「Music Like アプリの設計」

ユースケース:

- モバイルアプリ開発

- 対象: ARM64 実機優先

- x86 / x64: 開発・エミュレーター専用

- CI/CD: アーキテクチャ依存コードは分離して管理



言語 / フレームワーク:

- Flutter (Dart)


要件:

- ファイル分割は最小限にし、なるべく少ないDartファイルで構成

- ViewModel、UseCase、Repository はそれぞれ1ファイルにまとめる

- lib/ 配下に featureごとのフォルダを作らず、必要最低限のファイルだけ作成

- UIウィジェットはまだ生成しない

- ARM64 と x86/x64 のアーキテクチャを分離した構成にする

- 各ファイルには役割を示すコメントを入れる

提示された仕様書（Music Like アプリ）と要件（Flutter, Clean Architecture, Riverpod, アーキテクチャ分離, ファイル集約）に基づき、モバイルアプリのディレクトリ構成とコードスケルトンを作成しました。

YouTube音声抽出・タグ付与機能 設計書
1. 概要
本設計書は、youtube_explode_dart と FFmpeg を使用し、YouTube動画から以下の情報および音声データを取得し、指定された形式の音声ファイルとして出力する機能について定義する。
対象プラットフォームは Flutter (Dart) を想定する。

2. 実現したいゴール（要件定義）
2.1 入力
YouTube動画URL
2.2 取得対象データ
動画タイトル
チャンネル名
サムネイルURL
音声のみストリーム（Audio Only）
2.3 出力仕様（音声ファイル）
項目
内容
ファイル形式
M4A / MP3 / FLAC（ユーザー選択）
ファイル名
動画タイトル
タイトルタグ
動画タイトル
アーティストタグ
チャンネル名
アルバムタグ
チャンネル名
ジャケット画像
サムネイル画像


3. 使用技術・ライブラリ
3.1 Dart / Flutter 側
youtube_explode_dart
http / dio（ファイルダウンロード用）
path_provider（保存先取得）
3.2 ネイティブ / 外部ツール
FFmpeg（音声変換・メタデータ付与）
ffmpeg-kit（Flutterプラグイン）

4. 全体アーキテクチャ
[YouTube URL]
      ↓
youtube_explode_dart
      ↓
動画メタ情報 / 音声ストリームURL取得
      ↓
音声ストリームダウンロード（一次ファイル）
      ↓
FFmpeg
  ├ 音声変換（M4A / MP3 / FLAC）
  └ メタデータ + ジャケット埋め込み
      ↓
完成音声ファイル出力


5. 機能別設計
5.1 動画情報取得機能
処理内容
YouTube URL を受け取る
youtube_explode_dart により動画情報を取得
取得項目
video.title
video.author
video.thumbnails.highResUrl

5.2 音声ストリーム選択機能
方針
映像を含まない Audio Only Stream を使用
音質優先で bitrate が最大のものを選択
対象形式
webm (opus)
mp4 (aac)
※ 最終形式は FFmpeg により統一変換する

5.3 音声ストリームダウンロード
処理内容
選択した音声ストリームURLを取得
一時ディレクトリへ保存
拡張子は元ストリームに準拠（例: .webm / .m4a）

5.4 サムネイル画像取得
処理内容
高解像度サムネイルURLを使用
jpg/png形式で一時保存

5.5 音声変換・メタデータ埋め込み（FFmpeg）
共通メタデータ
title = 動画タイトル
artist = チャンネル名
album = チャンネル名
cover = サムネイル画像

5.5.1 M4A 出力
ffmpeg -i input.audio \
       -i cover.jpg \
       -map 0:a -map 1:v \
       -c:a aac -c:v copy \
       -metadata title="動画タイトル" \
       -metadata artist="チャンネル名" \
       -metadata album="チャンネル名" \
       -disposition:v attached_pic \
       output.m4a


5.5.2 MP3 出力
ffmpeg -i input.audio \
       -i cover.jpg \
       -map 0:a -map 1:v \
       -c:a libmp3lame \
       -metadata title="動画タイトル" \
       -metadata artist="チャンネル名" \
       -metadata album="チャンネル名" \
       -id3v2_version 3 \
       -disposition:v attached_pic \
       output.mp3


5.5.3 FLAC 出力
ffmpeg -i input.audio \
       -i cover.jpg \
       -map 0:a -map 1:v \
       -c:a flac \
       -metadata title="動画タイトル" \
       -metadata artist="チャンネル名" \
       -metadata album="チャンネル名" \
       output.flac


6. エラーハンドリング設計
ケース
対応
動画取得失敗
URL不正 / 非公開動画エラー
ストリーム取得失敗
再試行 or 中断
FFmpeg失敗
ログ取得・ユーザー通知
ファイル名不正文字
自動サニタイズ


7. 保存先
OS	推奨保存場所	
Android	外部ストレージ（Music / Downloads）	
iOS	App Documents ディレクトリ	